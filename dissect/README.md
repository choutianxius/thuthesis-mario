# Perform Network-Dissection on the Super Mario Bros DQN

This module performs 'network dissection' on our trained dqn model which plays the super mario bros game. The 'network dissection' methods heavily rely on [David Bau's work](https://github.com/davidbau/dissect) (`netdissect` and `experiment`). `./netdissect/upsegmeodel/` has been slightly modified to keep compatible with the Python and torch versions.

## Set up

Create two folders in the current directory

~~~shell
mkdir results resources
~~~

Then download the necessary resources (images and model weights) from this [link](https://drive.google.com/uc?id=1LBHXpqs3glKa1VBQoRv5dKpwJlf_PbJm&export=download) and extract it with `tar -xzf` into the `resources` folder. The final `resources` folder should contain `./resources/dissect_images/` (dataset to perform network dissection), `./resources/mario_net_86.chkpt` (DQN model weights) and `MarioSegmentationModel.pth` (segmenter model weights), or you can replace them with those generated by yourself.

## Torch Installation

- Python 3.10.x
- `torch`, tested with `2.1.0.dev20230514+cu121` (go to pytorch website for installation)
- `torchvision`, tested with `0.16.0.dev20230514+cu121` (install with `pip`)
- May need `ninja` for some modules from `netdissect` (install with `pip`)

## Perform Network Dissection

The main experiments reside in `./mydissect/mydissect.ipynb`. To run the notebook, first run `./mydissect/setup_notebooks.sh` in that folder.
